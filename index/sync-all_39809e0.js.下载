define("function-widget-1:puzzle/context.js",function(t,n,e){var o={context:null};e.exports={getContext:function(){return o.context},setContext:function(t){o.context=t}}});
;define("function-widget-1:puzzle/fileMeitu.js",function(e,t,n){function o(e,t,n){var o=new RegExp("(?:^|\\?|#|&)"+e+"=([^&#]*)(?:$|&|#)","i"),i=o.exec(n||location.href);return null!=i?n.replace(i[1],t):null}function i(){if(!u||10.2>u){var e=s().ui.confirm({title:"友好提示",body:"要使用图片在线编辑功能，您需要安装Flash播放器10.2.0 或更高的版本。",sureText:"安装",canceText:"取消",content:null,onSure:function(){e.hide(),window.open("http://get.adobe.com/cn/flashplayer","_blank")},onCancel:function(){e.hide()}});return e.show(),!1}return!0}var r=e("base:widget/libs/underscore.js"),s=(e("base:widget/libs/jquerypacket.js"),e("function-widget-1:puzzle/context.js").getContext),a=e("base:widget/storage/storage.js"),c=e("base:widget/tools/service/tools.flash.js"),u=c.getFlashVersion();n.exports=function(e,t){var n=i();if(!n)return!1;var c=e,u=encodeURIComponent(1===c.length?c[0].path:""),l=!0,p=r.map(c,function(e){/\.livp$/.test(e.server_filename)&&(l=!1);var t=e.thumb||e.thumbs.url3;return encodeURIComponent(o("size","c850_u580",t))});if(!l){var d=s().ui.alert({body:"<b>暂不支持美化实况照片</b>",width:"400px",className:"puzzle-livp-not-support",onSure:function(){d.hide()}});return!1}a.setItem("picArray",p),a.setItem("picPath",u),"object"==typeof window._hmt&&window._hmt.push(["_trackEvent","图片在线编辑","单张页点击美化入口的次数"]),"object"==typeof t&&t(),window.open(location.protocol+"//"+window.location.host+"/disk/editpic","_blank")}});
;define("function-widget-1:puzzle/start.js",function(t,e,i){var s=t("function-widget-1:puzzle/fileMeitu.js"),n=t("function-widget-1:puzzle/context.js");i.exports.start=function(t,e){var i;n.setContext(t),i="object"==typeof e&&e.filesList?e.filesList.length>0?e.filesList:[e.filesList]:t.list.getSelected(),s(i,e.callback)}});
;define("function-widget-1:log/start.js",function(o,t,i){for(var n=["linux","windows","win","mac","ipad"],a=navigator.platform.toLowerCase(),e=!0,r=0;r<n.length;r++)if(a.indexOf(n[r])>-1){e=!1;break}i.exports.start=function(o){e&&setTimeout(function(){o.updateLog.setLocalLog({product:"pan",op:"guardian",from:"browserPlugin",type:"modifyPlatform",detailKey:a})},500)}});
;define("function-widget-1:guide/context.js",function(e,t,n){function i(e){var t=e.y,n=e.m,i=e.d;e.timestamp&&(t=new Date(e.timestamp).getFullYear(),n=new Date(e.timestamp).getMonth()+1,i=new Date(e.timestamp).getDate());var a=new Date(t,n-1,i),o=new Date(t,0,1),r=Math.round((a.getTime()-o.getTime())/864e5);return Math.ceil((r+o.getDay())/7)}var a=e("base:widget/storage/storage.js"),o=e("function-widget-1:guide/log.js"),r=null;n.exports={getContext:function(){return r},setContext:function(e){r=e,r.log&&r.log.define&&r.log.define(o)},getYearWeek:i,getTipShowStatusForLocal:function(){var e="enterpriseTip_"+(window.yunData.MYUK||""),t=+new Date;if(a.getItem(e)){var n=a.getItem(e).split("_"),o=+n[0],r=+n[1],g=864e5;if(+r){var u=i({timestamp:t}),m=i({timestamp:o});if(t-o>g&&u===m)return!1}}return!0}}});
;define("function-widget-1:guide/log.js",function(o,e,i){var c={mix:{show_welcome_guide:{logType:"count",description:"显示新版欢迎引导"},welcome_guide_begin:{logType:"count",description:"体验引导，点击立即体验按钮"},welcome_guide_close:{logType:"count",description:"体验引导，点击关闭按钮"},disk_home_coupon_banner_display:{logType:"count",description:"网盘优惠券广告位展现"},coupon_consume_active_banner_click:{logType:"count",description:"网盘优惠券广告位点击"},coupon_consume_active_banner_close:{logType:"count",description:"网盘优惠券广告位关闭"},disk_home_dialog_consume_coupon_click:{logType:"count",description:"网盘优惠券领取成功"},disk_home_gift_banner_display:{logType:"count",description:"网盘满赠广告位展现"},show_picNew_guide:{logType:"count",description:"显示图片分类引导"},picNew_guide_close:{logType:"count",description:"关闭图片分类引导，点击[去看看]"},cardHolder_activity_show:{logType:"count",description:"卡包活动引导"},cardHolder_activity_close:{logType:"count",description:"卡包活动引导关闭"},cardHolder_activity_addBtn_enter_cardholder:{logType:"count",description:"卡包活动引导点击立即添加进入卡包"},cardHolder_activity_addBtn_click:{logType:"count",description:"卡包活动引导点击立即添加"},cardHolder_importDialog_show:{logType:"count",description:"卡包一键导入"},cardHolder_import_close:{logType:"count",description:"卡包一键导入引导关闭"},cardHolder_import_recognition_click:{logType:"count",description:"卡包一键导入引导点击立即识别"},cardHolder_import_recognition_success:{logType:"count",description:"卡包一键导入引导识别成功"},cardHolder_import_keyimport_click:{logType:"count",description:"卡包一键导入引导点击一键导入"},cardHolder_import_enter_cardholder:{logType:"count",description:"卡包一键导入引导进入到卡包"},cardHolder_import_keyimport_success:{logType:"count",description:"卡包一键导入导入成功"},cardHolder_import_keyimport_fail:{logType:"count",description:"卡包一键导入导入失败"},cardHolder_import_keyimport_fail:{logType:"count",description:"卡包一键导入导入失败"},guide_march_activity_tip_click:{logType:"count",description:"三月抽奖活动tip提示点击"}}};i.exports=c});
;define("function-widget-1:guide/guideQueue.js",function(e,t,i){function n(e){return this instanceof n?(this.hideCurrentTip=null,this.hasInited=!1,this.params=e||null,this._watch=null,this.list=[],this.hashChangeList=[],void(this.selectChangeList=[])):new n(e)}var s=e("base:widget/libs/underscore.js"),h=e("base:widget/libs/jquerypacket.js"),a=e("function-widget-1:guide/context.js").getContext,r=e("base:widget/storage/storage.js"),o=e("base:widget/tools/service/tools.url.js"),u=1,d=2,c=3;n.prototype.init=function(){if(!this.hasInited){this.listenHashChange(),this.listenSelectChange(),this.hasInited=!0;var e=this,t=a().message;t.listenSystem("guide:hide",function(){s.isFunction(e.hideCurrentTip)&&e.hideCurrentTip()}),t.listenSystem("guide:reflow",function(){e.hasInited&&e.dequeue()})}},n.prototype.setParams=function(e){this.params=e},n.prototype.enqueue=function(e){s.isArray(e)?[].push.apply(this.list,e):this.list.push(e),this.handleChangeQueue()},n.prototype.handleChangeQueue=function(){for(var e,t=[],i=[],n=0;n<this.list.length;n++)e=this.list[n],e.__index__=n,e.hashChange?t.push(h.extend(!0,{},e)):e.selectChange&&i.push(h.extend(!0,{},e));this.hashChangeList=t,this.selectChangeList=i},n.prototype.listenHashChange=function(){var e=this,t=a().router,i=this._watch=s.debounce(function(){if(e.hasInited){var t=e.hashChangeList;if(0!==t.length){for(var i=[],n=0;n<t.length;n++)i.push(h.extend(!0,{},t[n]));i.length>0&&(e.list=i,e._dequeue())}}},500);t.eachEnter(i),t.query.watch("vmode",i),t.query.watch("type",i),t.query.watch("path",i),t.query.watch("key",i)},n.prototype.listenSelectChange=function(){function e(){if(t.hasInited){var e=t.selectChangeList;if(0!==e.length){var i=a().getList().getCheckedItems();if(0!==i.length){for(var n,s=[],r=0;r<e.length;r++){n=h.extend(!0,{},e[r]);var o=n.selectChange;if(o!==!0){if("object"==typeof o){var u=!0,d=o.filesLimit;d&&(/^\d+$/.test(d)?u=i.length===+d:/^<\d+$/.test(d)?u=i.length<d.substring(1):/^>\d+$/.test(d)&&(u=i.length>d.substring(1)));var c=o.type;if(c&&"*"!==c)for(var l=0;l<i.length;l++)if("dir"===c&&0===+i[l].isdir)u=!1;else if("dir"!==c){var g=i[l].server_filename.split("."),f=g[g.length-1];u=c===f}u&&s.push(n)}}else s.push(n)}s.length>0&&(t.list=s,t._dequeue())}}}}var t=this;a().message.instanceForSystem.listen("system-checked-changed",s.debounce(e,500))},n.prototype.dequeue=function(){this._dequeue()},n.prototype.preHandle=function(){var e=this.list.shift();if(!e)return u;var t=e.key?r.getItem(e.key):"",i=e.pageType?e.pageType:"",n=e.pageFrom?e.pageFrom:"",h=e.period?e.period.start:"",d=e.period?e.period.termination:"",l=(new Date).getTime(),g=!!t,f=a().router.currentRouteName,p=!0,y=!0;if(s.isFunction(e.checkStorageItem)&&(g=e.checkStorageItem(t)),h&&d&&(y=!(h>l||l>d)),i&&i.length>0&&(p=!(-1===i.indexOf(f)||!f)),n&&n.length>0){var v=o.getParam("jumpFrom");if(-1!==n.indexOf(v))return!e.ignore&&y&&p?e:c}return!e.ignore&&y&&!g&&p?e:c},n.prototype._dequeue=function(e,t){var i;if(void 0===e){var n=this.preHandle();if(s.isObject(n))i=n;else{if(n!==c)return;this._dequeue()}}else{if(!e)return this.list.shift(),void this._dequeue();i=this.list.shift(),t&&(i.data=t)}if(s.isObject(i))if(i.asyncCanShow!==!0){var h=this._guideHandle(i);h===c&&this._dequeue()}else{if(!s.isFunction(i.canShow))throw new Error("If the asyncCanShow has been set true,and the canShow was must be a function.");var a=i.canShow;i.asyncCanShow=void 0,i.canShow=void 0,this.list.unshift(i),a(this.params)}},n.prototype.goAhead=function(e,t){var i=this.list[0];if(i){if(i.canShow=e,e){var n="";i.hashChange?n="hashChangeList":i.selectChange&&(n="selectChangeList"),n&&(this[n]=this[n].filter(function(e){return e.__index__!==i.__index__}))}this._dequeue(e,t)}},n.prototype._guideHandle=function(t){if(s.isFunction(t))t();else{var i=this,n=this.params,h=s.isFunction(t.canShow)?t.canShow(n):t.canShow;if(void 0===h&&(h=!0),!h)return c;if(t.path&&(t.delay?setTimeout(function(){e.async(t.path,function(e){i.hideCurrentTip=e.show(n,t.data)})},t.delay):e.async(t.path,function(e){i.hideCurrentTip=e.show(n,t.data)})),!t.ManualKeyOperate&&t.key&&r.setItem(t.key,!0),t.goNext===!1)return d}return c},i.exports=n});
;define("function-widget-1:guide/start.js",function(e,i,t){var a=(e("base:widget/libs/underscore.js"),e("base:widget/libs/jquerypacket.js")),o=e("function-widget-1:guide/context.js"),n=o.getContext,r=e("function-widget-1:guide/guideQueue.js"),s=e("base:widget/storage/storage.js"),c=r(),u=window.yunData||{};c.enqueue([{asyncCanShow:!0,ManualKeyOperate:!0,key:"capacity_update_uk_"+u.MYUK,pageType:"list",canShow:function(){c.goAhead(!!+u.volAutoup)},path:"function-widget-1:guide/util/capacityUpdateTip/capacityUpdateTip.js",goNext:!1},{hashChange:!0,asyncCanShow:!0,pageType:"sharedir",canShow:function(){function e(){var e=a.diffAll,i=e.shareDirRootChangeList;i.length?(a.diffAll.removeDiffMsg("shareDirRoot"),c.goAhead(!0,i)):c.goAhead(!1)}var i=n(),t=i.router.query.get("path");if("/"!==t)return void c.goAhead(!1);{var a=n().tools.shareDirManager;a.diffAll}i.message.listenSystem("after-share-dir-root-diffall",function(){e()},!0)},path:"function-widget-1:guide/util/shareDirTip/shareDirRootChange.js",goNext:!1},{hashChange:!0,pageType:"list",asyncCanShow:!0,canShow:function(){function e(){for(var e=i.tools.shareDirManager,a=e.diffAll,o=a.dismissMsgList,n=0;n<o.length;n++)if(o[n].path===t)return e.diffAll.removeDiffMsg("dismiss",t),void c.goAhead(!0);c.goAhead(!1)}var i=n(),t=i.router.query.get("path"),a=i.tools.shareDirManager,o=a.diffAll;o&&o.dismissMsgList&&o.initDataReady?e():i.message.listenSystem("after-share-dir-root-diffall",function(){e()},!0)},path:"function-widget-1:guide/util/shareDirTip/setShareDismiss.js",goNext:!1},{key:"showAblity_uk_"+u.MYUK,asyncCanShow:!0,pageType:"list",canShow:function(){a.ajax({url:"/api/account/rookie?type=8",dataType:"json",success:function(e){c.goAhead(0===e.errno&&e.list&&0===+e.list[8])},error:function(){c.goAhead(!1)}})},path:"function-widget-1:guide/util/ablityShow/ablityShow.js",goNext:!1},{asyncCanShow:!0,pageType:"list",key:u.MYUK+"_card_space",checkStorageItem:function(e){return e&&"true"===e},canShow:function(){a.ajax({url:"/aipic/cardcatalog/addvolume?isadd=0",dataType:"json",success:function(e){c.goAhead(0===e.errno&&0===e.status&&"undefined"!=typeof e.msg,e.msg)},error:function(){c.goAhead(!1)}})},path:"function-widget-1:guide/util/cardHolder/cardHolderGiveSpace/cardHolderGiveSpace.js",goNext:!1},{asyncCanShow:!0,pageType:"list",key:u.MYUK+"_card_import",checkStorageItem:function(e){if(!e||"false"===e)return!1;if(e.indexOf("_")>-1){var i=e.split("_");if("true"===i[0])return!0;var t=+new Date-parseInt(i[1],10);return!(t>864e5)}return!1},canShow:function(){a.ajax({url:"/aipic/cardcatalog/importable",dataType:"json",success:function(e){c.goAhead(0===e.errno&&e.importable,e)},error:function(){c.goAhead(!1)}})},path:"function-widget-1:guide/util/cardHolder/cardHolderKeyImport/cardHolderKeyImport.js",goNext:!1},{asyncCanShow:!0,pageType:"list",key:u.MYUK+"_card_tip",canShow:function(){a.ajax({url:"/aipic/cardcatalog/newuser",dataType:"json",success:function(e){c.goAhead(0===e.errno&&e.newuser)},error:function(){c.goAhead(!1)}})},path:"function-widget-1:guide/util/cardHolder/cardHolderTip/cardHolderTip.js",goNext:!1},{key:"guideShareDirTip_"+u.MYUK,pageType:"list",path:"function-widget-1:guide/util/shareDirTip/shareDirTip.js",goNext:!1},{ignore:!0,asyncCanShow:!0,key:"picNewNotice",pageType:"list",canShow:function(){a.ajax({url:"/api/categorylist",dataType:"json",data:{category:3},success:function(e){e&&0===e.errno&&e.info&&e.info.length>0&&a.ajax({url:"/api/account/rookie?type=16",dataType:"json",success:function(e){c.goAhead(0===e.errno&&e.list&&0===+e.list[16]),s.setItem("picNewNotice",!0),n().log.send({type:"show_picNew_guide"})},error:function(){c.goAhead(!1)}})},error:function(){c.goAhead(!1)}})},path:"function-widget-1:guide/util/picNewTip/picNewTip.js",goNext:!1},{ignore:!0,key:u.MYNAME+"classifyTip",canShow:function(){return window.location.href.indexOf("timeline")>-1},path:"function-widget-1:guide/util/classifyTip/classifyTip.js",goNext:!1},{canShow:function(e){return!!e.isVip},path:"function-widget-1:guide/util/trialVipTip/trialVipTip.js"},{asyncCanShow:!0,canShow:function(){a.ajax({url:"/enterprise/user/check",dataType:"json",success:function(e){c.goAhead(1===+e.result?!1:o.getTipShowStatusForLocal())},error:function(){c.goAhead(!1)}})},path:"function-widget-1:guide/util/enterpriseTip/enterpriseTip.js"},{key:u.MYNAME+"_director_guide",path:"function-widget-1:guide/util/directorTip/directorTip.js"},{delay:2e3,ManualKeyOperate:!0,canShow:function(){return!!n().getList()},path:"function-widget-1:guide/util/openFileTip/openFileTip.js"}]),t.exports.start=function(e,i){if(o.setContext(e),"pan"===e.pageInfo.currentProduct){if(i&&i.message)return void e.message.trigger(i.message);c.init(),c.setParams(i),c.dequeue()}}});
;define("function-widget-1:download/log.js",function(o,e,t){t.exports={event:{},ajax:{"/api/download":{logType:"dis",description:"下载文件",callback:function(o,e){return[{name:"downloadHttpTime",value:e&&e.time},{name:"downloadHttpStatus",value:e&&e.responseData&&e.responseData.errno}]}}},mix:{chromeStraightforwardDownload:{logType:"count",description:"chrome直接下载文件"},httpsAccessFail:{logType:"count",description:"https访问失败"},httpsAccessSuccess:{logType:"count",description:"https访问成功"},https_pub:{logType:"count",description:"是否命中https访问的小流量"},callGuanjia:{logType:"count",description:"是否成功调起云管家"},tab_download_click:{logType:"count",description:"选中文件后点上方按钮文件下载"},list_download_click:{logType:"count",description:"列表下载按钮文件下载"},file_down_count:{logType:"count",description:"文件下载统计(不包含文件夹)"},call_guanjia_local:{logType:"count",description:"下载本地服务调起"},call_guanjia_server:{logType:"count",description:"下载长连接方式调起"},getBrowserIdByServer:{logType:"count",description:"发送长连接调起browserId请求"},checkIsOnlineByServer:{logType:"count",description:"发送长连接调起online请求"},callGuanjiaByServer:{logType:"count",description:"发送长连接调起send请求"},checkGuanjiaStatusByServer:{logType:"count",description:"发送长连接调起check请求"}}}});
;define("function-widget-1:download/util/context.js",function(t,n,e){var o=t("function-widget-1:download/log.js"),i=/\.(\w+)$/,u=null;e.exports={getContext:function(){return u},setContext:function(t){u||(u=t,t&&t.log&&t.log.define(o))},getExtName:function(t){if("string"!=typeof t)return"";var n=i.exec(t);return n[1]?n[1]:""}}});
;define("function-widget-1:download/start.js",function(n,i,t){function e(i,t,e,o){n.async("function-widget-1:download/service/dlinkService.js",function(n){switch(e){case"mbox":break;case"share":n.getDlinkShare(i,t);break;case"normal":default:n.getDlinkPan(i,o||"nolimit",function(n){"function"==typeof t&&t(n)},void 0,void 0,"POST")}})}function o(i,t){var o,c=null;if(a.setContext(i),"object"==typeof t&&t.filesList){if(c=t.filesList.length>0?t.filesList:[t.filesList],o=!!t.hasDlink,t.getDlink&&t.callback){var r=s.pluck(c,"fs_id");return void e(r,t.callback,t.filePosition)}}else if("string"==typeof t)c=[{dlink:t}],o=!0;else{if("object"==typeof t&&t.fsids&&t.getDlink)return void e(t.fsids,t.callback,t.filePosition);c=i.list.getSelected()}n.async("function-widget-1:download/controller/downloadController.js",function(n){var e={list:c,hasDlink:o};"share"===i.pageInfo.currentProduct&&(e={list:c,product:t&&"unzip"===t.from?"pan":i.pageInfo.currentProduct,hasDlink:o,share_uk:l.SHARE_UK,share_id:l.SHARE_ID,sign:l.SIGN,timestamp:l.timestamp}),n.download(e)})}var s=n("base:widget/libs/underscore.js"),l=window.yunData||{},a=n("function-widget-1:download/util/context.js");t.exports.start=function(n,i){l.SHAREPAGETYPE?window.yunHeader.nameVerify(function(){o(n,i)}):o(n,i)},t.exports.getDownloadLink=function(n,i){a.setContext(n),e(i.config,i.callback,i.type,i.linkType)}});